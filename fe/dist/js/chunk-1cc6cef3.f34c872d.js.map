{"version":3,"sources":["webpack:///./src/views/pages/user/Chat.vue?da70","webpack:///src/views/pages/user/Chat.vue","webpack:///./src/views/pages/user/Chat.vue?289c","webpack:///./src/views/pages/user/Chat.vue?4248","webpack:///../../../src/components/VAppBar/VAppBarNavIcon.ts","webpack:///./src/views/pages/user/Chat.vue?dbc9"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","staticClass","on","$event","stopPropagation","setDrawerState","apply","arguments","_l","msg","index","key","class","sentOrReceived","userUID","_v","_s","text","ref","preventDefault","sendMessage","directives","name","rawName","value","expression","domProps","target","composing","message","staticRenderFns","data","computed","methods","component","VAppBarNavIcon","VCol","VContainer","VRow","functional","d","Object","props","icon","listeners","defaultSlot","slots","h"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,cAAc,GAAG,CAACA,EAAG,QAAQ,CAACE,MAAM,CAAC,MAAQ,SAAS,QAAU,WAAW,CAACF,EAAG,QAAQ,CAACG,YAAY,YAAYD,MAAM,CAAC,KAAO,KAAK,GAAK,KAAK,GAAK,KAAK,GAAK,OAAO,CAACF,EAAG,qBAAqB,CAACG,YAAY,OAAOC,GAAG,CAAC,MAAQ,SAASC,GAAiC,OAAzBA,EAAOC,kBAAyBV,EAAIW,eAAeC,MAAM,KAAMC,eAAeT,EAAG,UAAU,CAACA,EAAG,OAAO,CAACJ,EAAIc,GAAId,EAAY,UAAE,SAASe,EAAIC,GAAO,OAAOZ,EAAG,MAAM,CAACa,IAAI,SAAWD,EAAME,MAAM,CAAC,UAAWlB,EAAImB,eAAeJ,EAAIK,WAAW,CAAChB,EAAG,IAAI,CAACJ,EAAIqB,GAAGrB,EAAIsB,GAAGP,EAAIQ,cAAanB,EAAG,MAAM,CAACoB,IAAI,gBAAgB,GAAGpB,EAAG,OAAO,CAACI,GAAG,CAAC,OAAS,SAASC,GAAgC,OAAxBA,EAAOgB,iBAAwBzB,EAAI0B,YAAYd,MAAM,KAAMC,cAAc,CAACT,EAAG,QAAQ,CAACuB,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAO9B,EAAW,QAAE+B,WAAW,YAAYzB,MAAM,CAAC,KAAO,OAAO,YAAc,uBAAuB0B,SAAS,CAAC,MAAShC,EAAW,SAAGQ,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAOwB,OAAOC,YAAqBlC,EAAImC,QAAQ1B,EAAOwB,OAAOH,WAAU1B,EAAG,SAAS,CAACG,YAAY,WAAWD,MAAM,CAAC,UAAYN,EAAImC,QAAQ,KAAO,WAAW,CAACnC,EAAIqB,GAAG,aAAa,IAAI,IAAI,IAC1oCe,EAAkB,G,0FC4BtB,GACE,QADF,WACA,qKACA,6CADA,SAEA,wCAFA,cAIA,yCACA,+CACA,yBACA,0BACA,yDARA,SAWA,iBAXA,8CAaEC,KAdF,WAeA,OACA,mBACA,WACA,YACA,YAGEC,SAAU,OAAZ,OAAY,CAAZ,GACA,iCAEEC,QAAS,CACX,eADA,WAEA,gDAEA,eAJA,SAIA,GACA,uDAEA,aAPA,WAOA,8JACA,yCACA,+CACA,yBACA,0BACA,uBACA,yCACA,8BAPA,8CAYA,YAnBA,WAmBA,qKACA,GACA,8BACA,6DACA,eACA,qBACA,6BACA,SAPA,SASA,mCATA,uBAUA,iBAVA,OAWA,aACA,0DAZA,gDCzE4W,I,6FCQxWC,EAAY,eACd,EACAzC,EACAqC,GACA,EACA,KACA,WACA,MAIa,aAAAI,EAAiB,QAQhC,IAAkBA,EAAW,CAACC,iBAAA,KAAeC,OAAA,KAAKC,aAAA,KAAWC,OAAA,Q,2HCnB9C,qBAAW,CACxBhB,KADwB,qBAGxBiB,YAHwB,EAKxB9C,OALwB,SAKlB,EALkB,GAKoB,IAAjC,EAAiC,EAAjC,QAAiC,EAAjC,YAAiC,EAAjC,MAA2BsC,EAAM,EAANA,KAC9BS,EAAIC,OAAA,SAAoB,CAC5BxC,YAAc,8BAAuB8B,EAAA,aAAxB,IADe,OAE5BW,MAAO,oCAAF,IAEHC,MAAM,IAERzC,GAAI0C,IAGAC,EAAcC,IAApB,QAEA,OAAOC,EAAE,EAAD,OAAUF,GAAe,CAACE,EAAE,EAAD,KAAnC,e,kCCzBJ","file":"js/chunk-1cc6cef3.f34c872d.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{},[_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-col',{staticClass:\"mr-6 ml-6\",attrs:{\"cols\":\"12\",\"sm\":\"10\",\"md\":\"10\",\"lg\":\"10\"}},[_c('v-app-bar-nav-icon',{staticClass:\"mt-6\",on:{\"click\":function($event){$event.stopPropagation();return _vm.setDrawerState.apply(null, arguments)}}}),_c('section',[_c('main',[_vm._l((_vm.messages),function(msg,index){return _c('div',{key:'index-' + index,class:['message', _vm.sentOrReceived(msg.userUID)]},[_c('p',[_vm._v(_vm._s(msg.text))])])}),_c('div',{ref:\"scrollable\"})],2),_c('form',{on:{\"submit\":function($event){$event.preventDefault();return _vm.sendMessage.apply(null, arguments)}}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.message),expression:\"message\"}],attrs:{\"type\":\"text\",\"placeholder\":\"Enter your message!\"},domProps:{\"value\":(_vm.message)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.message=$event.target.value}}}),_c('button',{staticClass:\"btn-send\",attrs:{\"disabled\":!_vm.message,\"type\":\"submit\"}},[_vm._v(\"ðŸ“©\")])])])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n <v-container class=\"\">\r\n  <v-row align=\"center\" justify=\"center\">\r\n   <v-col cols=\"12\" sm=\"10\" md=\"10\" lg=\"10\" class=\"mr-6 ml-6\">\r\n    <v-app-bar-nav-icon class=\"mt-6\" @click.stop=\"setDrawerState\"></v-app-bar-nav-icon>\r\n    <section>\r\n     <main>\r\n      <div\r\n       v-for=\"(msg, index) in messages\"\r\n       v-bind:key=\"'index-' + index\"\r\n       :class=\"['message', sentOrReceived(msg.userUID)]\"\r\n      >\r\n       <p>{{ msg.text }}</p>\r\n      </div>\r\n      <div ref=\"scrollable\"></div>\r\n     </main>\r\n\r\n     <form v-on:submit.prevent=\"sendMessage\">\r\n      <input v-model=\"message\" type=\"text\" placeholder=\"Enter your message!\" />\r\n      <button class=\"btn-send\" :disabled=\"!message\" type=\"submit\">ðŸ“©</button>\r\n     </form>\r\n    </section>\r\n   </v-col>\r\n  </v-row>\r\n </v-container>\r\n</template>\r\n<script>\r\n import { mapState } from 'vuex';\r\n import firebase from 'firebase';\r\n export default {\r\n  async mounted() {\r\n   document.title = 'Chat Application - Evsu-TES';\r\n   await this.$store.dispatch('auth/checkAuthUser');\r\n\r\n   let query = firebase.firestore().collection('messages');\r\n   query = query.where('chatID', '==', this.user.student_number);\r\n   query = query.orderBy('createdAt');\r\n   query.onSnapshot((querySnap) => {\r\n    this.messages = querySnap.docs.map((doc) => doc.data());\r\n   });\r\n\r\n   await this.updateUnread();\r\n  },\r\n  data() {\r\n   return {\r\n    db: firebase.firestore(),\r\n    message: '',\r\n    messages: [],\r\n    chatID: '',\r\n   };\r\n  },\r\n  computed: {\r\n   ...mapState('auth', ['user']),\r\n  },\r\n  methods: {\r\n   setDrawerState() {\r\n    this.$store.commit('updates/SET_DRAWER_STATE');\r\n   },\r\n   sentOrReceived(userUID) {\r\n    return userUID === this.user.student_number ? 'sent' : 'received';\r\n   },\r\n   async updateUnread() {\r\n    let updateUnseen = firebase.firestore().collection('messages');\r\n    updateUnseen = updateUnseen.where('chatID', '==', this.user.student_number);\r\n    updateUnseen = updateUnseen.orderBy('createdAt');\r\n    updateUnseen.get().then((query) => {\r\n     query.forEach((doc) => {\r\n      if (doc.data().userUID != this.user.student_number) {\r\n       doc.ref.update({ seen: true });\r\n      }\r\n     });\r\n    });\r\n   },\r\n   async sendMessage() {\r\n    const messageInfo = {\r\n     userUID: this.user.student_number,\r\n     displayName: this.user.info.first_name + ' ' + this.user.info.last_name,\r\n     text: this.message,\r\n     createdAt: Date.now(),\r\n     chatID: this.user.student_number,\r\n     seen: false,\r\n    };\r\n    await this.db.collection('messages').add(messageInfo);\r\n    await this.updateUnread()\r\n    this.message = '';\r\n    this.$refs['scrollable'].scrollIntoView({ behavior: 'smooth' });\r\n   },\r\n  },\r\n };\r\n</script>\r\n\r\n<style scoped>\r\n section {\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n }\r\n\r\n section main {\r\n  padding: 10px;\r\n  height: 100%;\r\n  overflow-y: scroll;\r\n  display: flex;\r\n  flex-direction: column;\r\n  max-height: 78vh;\r\n  min-height: 78vh;\r\n }\r\n\r\n form {\r\n  height: 6vh;\r\n  bottom: 0;\r\n  width: 100%;\r\n  display: flex;\r\n  margin-top: 5px;\r\n  font-size: 1rem;\r\n }\r\n\r\n input {\r\n  line-height: 1.3;\r\n  width: 100%;\r\n  font-size: 1rem;\r\n  outline: none;\r\n  border: none;\r\n  padding: 0 15px;\r\n }\r\n\r\n input {\r\n  color: rgb(0, 0, 0);\r\n  border-top-left-radius: 5px;\r\n  border-bottom-left-radius: 5px;\r\n  border: 1px solid grey;\r\n }\r\n\r\n p {\r\n  max-width: 500px;\r\n  margin-bottom: 12px;\r\n  line-height: 24px;\r\n  padding: 10px 20px;\r\n  border-radius: 25px;\r\n  position: relative;\r\n  color: white;\r\n  text-align: center;\r\n }\r\n\r\n .message {\r\n  display: flex;\r\n  align-items: center;\r\n }\r\n .message.received p {\r\n  background: #e5e5ea;\r\n  margin-top: 3px;\r\n  color: #000;\r\n }\r\n .message.sent {\r\n  flex-direction: row-reverse;\r\n  align-self: flex-end;\r\n }\r\n\r\n .message.sent p {\r\n  color: #fff;\r\n  background: #0b93f6;\r\n  margin-top: 3px;\r\n }\r\n\r\n .btn-send {\r\n  background: #0b93f6;\r\n  padding: 0rem 1rem;\r\n  border-top-right-radius: 5px;\r\n  border-bottom-right-radius: 5px;\r\n }\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Chat.vue?vue&type=template&id=50711382&scoped=true&\"\nimport script from \"./Chat.vue?vue&type=script&lang=js&\"\nexport * from \"./Chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Chat.vue?vue&type=style&index=0&id=50711382&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"50711382\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VAppBarNavIcon } from 'vuetify/lib/components/VAppBar';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VRow } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VAppBarNavIcon,VCol,VContainer,VRow})\n","// Components\nimport VIcon from '../VIcon'\nimport VBtn from '../VBtn/VBtn'\n\n// Types\nimport Vue from 'vue'\n\n/* @vue/component */\nexport default Vue.extend({\n  name: 'v-app-bar-nav-icon',\n\n  functional: true,\n\n  render (h, { slots, listeners, props, data }) {\n    const d = Object.assign(data, {\n      staticClass: (`v-app-bar__nav-icon ${data.staticClass || ''}`).trim(),\n      props: {\n        ...props,\n        icon: true,\n      },\n      on: listeners,\n    })\n\n    const defaultSlot = slots().default\n\n    return h(VBtn, d, defaultSlot || [h(VIcon, '$menu')])\n  },\n})\n","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=style&index=0&id=50711382&scoped=true&lang=css&\""],"sourceRoot":""}