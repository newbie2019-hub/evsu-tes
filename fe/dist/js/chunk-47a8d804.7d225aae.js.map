{"version":3,"sources":["webpack:///./src/views/pages/admin/Chat.vue?15f1","webpack:///src/views/pages/admin/Chat.vue","webpack:///./src/views/pages/admin/Chat.vue?8797","webpack:///./src/views/pages/admin/Chat.vue?a9e0","webpack:///../../../src/components/VAppBar/VAppBarNavIcon.ts","webpack:///./src/views/pages/admin/Chat.vue?78c4","webpack:///../../../src/components/VCard/index.ts","webpack:///../../../src/components/VCard/VCard.ts"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","hasSelected","_e","staticClass","on","$event","stopPropagation","setDrawerState","apply","arguments","preventDefault","chatID","_v","_s","chatUserName","_l","msg","index","key","class","sentOrReceived","userUID","text","ref","sendMessage","directives","name","rawName","value","expression","domProps","target","composing","message","model","callback","$$v","search","filterStatus","getAccounts","selectedStatus","accounts","initialLoading","scopedSlots","_u","fn","items","item","id","retrieveMessages","info","first_name","last_name","email","status","unreadCount","staticRenderFns","data","computed","methods","watch","component","VAppBarNavIcon","VBtn","VCard","VCardTitle","VChip","VCol","VContainer","VDataIterator","VIcon","VLayout","VListItem","VListItemAvatar","VListItemContent","VList","VListItemSubtitle","VListItemTitle","VRow","VSelect","VTextField","functional","d","Object","props","icon","listeners","defaultSlot","slots","h","VCardActions","VCardSubtitle","VCardText","flat","hover","img","link","loaderHeight","type","Number","default","raised","Boolean","classes","styles","style","genProgress","tag","setBackgroundColor","$slots"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,cAAc,GAAG,CAACA,EAAG,QAAQ,CAACE,MAAM,CAAC,MAAQ,SAAS,QAAU,WAAW,CAACF,EAAG,QAAQ,CAACE,MAAM,CAAC,KAAO,KAAK,GAAK,KAAK,GAAK,KAAK,GAAK,MAAM,CAAGN,EAAIO,YAAoKP,EAAIQ,KAA3JJ,EAAG,qBAAqB,CAACK,YAAY,OAAOC,GAAG,CAAC,MAAQ,SAASC,GAAiC,OAAzBA,EAAOC,kBAAyBZ,EAAIa,eAAeC,MAAM,KAAMC,eAA0Bf,EAAIO,YAEi2BH,EAAG,UAAU,CAACA,EAAG,WAAW,CAACA,EAAG,QAAQ,CAACK,YAAY,YAAYH,MAAM,CAAC,KAAO,IAAII,GAAG,CAAC,MAAQ,SAASC,GAAQA,EAAOK,iBAAiBhB,EAAIO,aAAc,EAC35CP,EAAIiB,OAAS,MAAO,CAACb,EAAG,SAAS,CAACJ,EAAIkB,GAAG,sBAAsBd,EAAG,OAAO,GAAG,CAACJ,EAAIkB,GAAGlB,EAAImB,GAAGnB,EAAIoB,kBAAkB,IAAI,GAAGhB,EAAG,OAAO,CAACJ,EAAIqB,GAAIrB,EAAY,UAAE,SAASsB,EAAIC,GAAO,OAAOnB,EAAG,MAAM,CAACoB,IAAI,SAAWD,EAAME,MAAM,CAAC,UAAWzB,EAAI0B,eAAeJ,EAAIK,WAAW,CAACvB,EAAG,IAAI,CAACJ,EAAIkB,GAAGlB,EAAImB,GAAGG,EAAIM,cAAaxB,EAAG,MAAM,CAACyB,IAAI,gBAAgB,GAAGzB,EAAG,OAAO,CAACM,GAAG,CAAC,OAAS,SAASC,GAAgC,OAAxBA,EAAOK,iBAAwBhB,EAAI8B,YAAYhB,MAAM,KAAMC,cAAc,CAACX,EAAG,QAAQ,CAAC2B,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOlC,EAAW,QAAEmC,WAAW,YAAY7B,MAAM,CAAC,KAAO,OAAO,YAAc,uBAAuB8B,SAAS,CAAC,MAASpC,EAAW,SAAGU,GAAG,CAAC,MAAQ,SAASC,GAAWA,EAAO0B,OAAOC,YAAqBtC,EAAIuC,QAAQ5B,EAAO0B,OAAOH,WAAU9B,EAAG,SAAS,CAACK,YAAY,WAAWH,MAAM,CAAC,UAAYN,EAAIuC,QAAQ,KAAO,WAAW,CAACvC,EAAIkB,GAAG,WAAW,GAHnad,EAAG,WAAW,CAACK,YAAY,OAAOH,MAAM,CAAC,OAAS,KAAK,CAACF,EAAG,eAAe,CAACA,EAAG,eAAe,CAACK,YAAY,OAAOH,MAAM,CAAC,cAAc,cAAc,MAAQ,SAAS,cAAc,GAAG,eAAe,GAAG,SAAW,IAAIkC,MAAM,CAACN,MAAOlC,EAAU,OAAEyC,SAAS,SAAUC,GAAM1C,EAAI2C,OAAOD,GAAKP,WAAW,aAAa,GAAG/B,EAAG,eAAe,CAACA,EAAG,WAAW,CAACE,MAAM,CAAC,MAAQN,EAAI4C,aAAa,MAAQ,SAAS,SAAW,IAAIlC,GAAG,CAAC,OAASV,EAAI6C,aAAaL,MAAM,CAACN,MAAOlC,EAAkB,eAAEyC,SAAS,SAAUC,GAAM1C,EAAI8C,eAAeJ,GAAKP,WAAW,qBAAqB,GAAG/B,EAAG,KAAK,CAACK,YAAY,sCAAsC,CAACT,EAAIkB,GAAG,mCAAmCd,EAAG,kBAAkB,CAACE,MAAM,CAAC,UAAU,GAAG,MAAQN,EAAI+C,SAAS,QAAU/C,EAAIgD,gBAAgBC,YAAYjD,EAAIkD,GAAG,CAAC,CAAC1B,IAAI,UAAU2B,GAAG,SAAStB,GACjtC,IAAIuB,EAAQvB,EAAIuB,MAChB,OAAOpD,EAAIqB,GAAG,GAAQ,SAASgC,GAAM,OAAOjD,EAAG,SAAS,CAACoB,IAAI6B,EAAKC,GAAG7C,YAAY,OAAOH,MAAM,CAAC,KAAO,IAAII,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOX,EAAIuD,iBAAiBF,MAAS,CAACjD,EAAG,cAAc,CAACK,YAAY,QAAQ,CAACL,EAAG,WAAW,CAACE,MAAM,CAAC,eAAe,GAAG,uBAAuB,KAAK,CAACF,EAAG,WAAW,CAACA,EAAG,qBAAqB,CAACE,MAAM,CAAC,MAAQ,kBAAkB,CAAE+C,EAAKG,KAAU,MAAEpD,EAAG,MAAM,CAACE,MAAM,CAAC,IAAO,gCAAmC+C,EAAKG,KAAU,MAAG,OAAS,KAAK,MAAQ,KAAK,IAAM,mBAAmBpD,EAAG,OAAO,CAACK,YAAY,uBAAuB,CAACT,EAAIkB,GAAGlB,EAAImB,GAAGkC,EAAKG,KAAKC,WAAW,IAAIzD,EAAImB,GAAGkC,EAAKG,KAAKE,UAAU,SAAStD,EAAG,sBAAsB,CAACA,EAAG,oBAAoB,CAACJ,EAAIkB,GAAGlB,EAAImB,GAAGkC,EAAKG,KAAKC,YAAY,IAAIzD,EAAImB,GAAGkC,EAAKG,KAAKE,cAActD,EAAG,uBAAuB,CAACJ,EAAIkB,GAAGlB,EAAImB,GAAGkC,EAAKM,UAAUvD,EAAG,WAAW,CAACA,EAAG,SAAS,CAACK,YAAY,mBAAmBH,MAAM,CAAC,MAAuB,WAAf+C,EAAKO,OAAsB,eAAiB,iBAAiB,UAAU,KAAK,CAAC5D,EAAIkB,GAAGlB,EAAImB,GAAGkC,EAAKO,YAAY,IAAI,IAAI,GAAGxD,EAAG,MAAM,CAACA,EAAG,SAAS,CAAC2B,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASC,MAAOmB,EAAKQ,YAAc,EAAG1B,WAAW,yBAAyB1B,YAAY,mBAAmBH,MAAM,CAAC,MAAQ,iBAAiB,UAAU,KAAK,CAACN,EAAIkB,GAAGlB,EAAImB,GAAGkC,EAAKQ,iBAAiB,IAAI,IAAI,IAAI,SAAQ,MAAK,EAAM,eAAe,IAC1a,IAAI,IAAI,IAC/1BC,EAAkB,G,8GCiGtB,GACE,QADF,WACA,+JACA,6CADA,SAEA,oCAFA,uBAGA,gBAHA,OAIA,mBAJA,8CAMEC,KAPF,WAQA,OACA,mBACA,WACA,YACA,UACA,UACA,eACA,gBACA,gEACA,+BAGEC,SAAU,OAAZ,OAAY,CAAZ,kBACA,iCACA,qCAEEC,QAAS,CACX,eADA,WACA,wJACA,sBACA,4BACA,6CACA,0CACA,0BACA,0BACA,QACA,wBACA,6BACA,OAGA,sBAbA,8CAmBA,YApBA,WAoBA,wKACA,gFADA,8CAGA,iBAvBA,SAuBA,cACA,oBACA,6BACA,yDAEA,6CACA,0CACA,yBACA,0BACA,uBACA,6BACA,8BAKA,6CACA,0CACA,yBACA,0BACA,0DAGA,eA9CA,WA+CA,gDAEA,eAjDA,SAiDA,GACA,2CAEA,YApDA,WAoDA,qKACA,GACA,kBACA,6DACA,eACA,qBACA,gBACA,SAPA,SASA,mCATA,OAUA,aACA,0DAXA,+CAcEC,MAAO,CACT,OADA,WACA,WACA,yCACA,oCACA,kBACA,QCpM4W,I,6OCQxWC,EAAY,eACd,EACApE,EACA+D,GACA,EACA,KACA,WACA,MAIa,aAAAK,EAAiB,QAsBhC,IAAkBA,EAAW,CAACC,iBAAA,KAAeC,OAAA,KAAKC,QAAA,KAAMC,WAAA,OAAWC,QAAA,KAAMC,OAAA,KAAKC,aAAA,KAAWC,gBAAA,KAAcC,QAAA,KAAMC,UAAA,KAAQC,YAAA,KAAUC,kBAAA,KAAgBC,iBAAAC,EAAA,KAAiBC,kBAAAD,EAAA,KAAkBE,eAAAF,EAAA,KAAeG,OAAA,KAAKC,UAAA,KAAQC,aAAA,Q,6HCjC/L,qBAAW,CACxBtD,KADwB,qBAGxBuD,YAHwB,EAKxBxF,OALwB,SAKlB,EALkB,GAKoB,IAAjC,EAAiC,EAAjC,QAAiC,EAAjC,YAAiC,EAAjC,MAA2BgE,EAAM,EAANA,KAC9ByB,EAAIC,OAAA,SAAoB,CAC5BhF,YAAc,8BAAuBsD,EAAA,aAAxB,IADe,OAE5B2B,MAAO,oCAAF,IAEHC,MAAM,IAERjF,GAAIkF,IAGAC,EAAcC,IAApB,QAEA,OAAOC,EAAE,EAAD,OAAUF,GAAe,CAACE,EAAE,EAAD,KAAnC,e,6DCzBJ,W,oCCAA,kIAGMC,EAAe,eAArB,mBACMC,EAAgB,eAAtB,oBACMC,EAAY,eAAlB,gBACM3B,EAAa,eAAnB,iBAYI,Q,kICDW,sBAAO,EAAD,YAAN,eAIN,CACPvC,KADO,SAGP0D,MAAO,CACLS,KADK,QAELC,MAFK,QAGLC,IAHK,OAILC,KAJK,QAKLC,aAAc,CACZC,KAAM,CAACC,OADK,QAEZC,QAAS,GAEXC,OAAQC,SAGV5C,SAAU,CACR6C,QADQ,WAEN,sCACE,UADK,GAEF,qCAFE,OAAP,IAGE,eAAgB5G,KAHX,KAIL,gBAAiBA,KAJZ,MAKL,eAAgBA,KALX,YAML,kBAAmBA,KANd,QAOL,mBAAoBA,KAPf,SAQL,iBAAkBA,KARb,QASF,6CAGP6G,OAdQ,WAeN,IAAMC,EAAK,kBACN,2CAOL,OAJI9G,KAAJ,MACE8G,EAAA,0BAA2B9G,KAA3B,2CAGF,IAIJgE,QAAS,CACP+C,YADO,WAEL,IAAMjH,EAAS,wCAAf,MAEA,SAEOE,KAAKE,eAAe,MAAO,CAChCM,YADgC,mBAEhCe,IAAK,YACJ,CAHH,IAFoB,OASxBzB,OAvDO,SAuDD,GACJ,MAAsBE,KAAtB,oBAAM,EAAN,EAAM,IAAO8D,EAAb,EAAaA,KASb,OAPAA,EAAA,MAAa9D,KAAb,OAEIA,KAAJ,cACE8D,EAAA,MAAaA,EAAA,OAAb,GACAA,EAAA,kBAGKgC,EAAEkB,EAAKhH,KAAKiH,mBAAmBjH,KAAxB,MAAN,GAAiD,CACvDA,KADuD,cAEvDA,KAAKkH,OAFP","file":"js/chunk-47a8d804.7d225aae.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{},[_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-col',{attrs:{\"cols\":\"12\",\"sm\":\"10\",\"md\":\"10\",\"lg\":\"8\"}},[(!_vm.hasSelected)?_c('v-app-bar-nav-icon',{staticClass:\"mt-6\",on:{\"click\":function($event){$event.stopPropagation();return _vm.setDrawerState.apply(null, arguments)}}}):_vm._e(),(!_vm.hasSelected)?_c('v-layout',{staticClass:\"mt-7\",attrs:{\"column\":\"\"}},[_c('v-card-title',[_c('v-text-field',{staticClass:\"pt-0\",attrs:{\"append-icon\":\"mdi-magnify\",\"label\":\"Search\",\"single-line\":\"\",\"hide-details\":\"\",\"outlined\":\"\"},model:{value:(_vm.search),callback:function ($$v) {_vm.search=$$v},expression:\"search\"}})],1),_c('v-card-title',[_c('v-select',{attrs:{\"items\":_vm.filterStatus,\"label\":\"Status\",\"outlined\":\"\"},on:{\"change\":_vm.getAccounts},model:{value:(_vm.selectedStatus),callback:function ($$v) {_vm.selectedStatus=$$v},expression:\"selectedStatus\"}})],1),_c('h4',{staticClass:\"mt-3 mb-3 ml-4 font-weight-regular\"},[_vm._v(\"Select a user to start a chat\")]),_c('v-data-iterator',{attrs:{\"sort-by\":\"\",\"items\":_vm.accounts,\"loading\":_vm.initialLoading},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar items = ref.items;\nreturn _vm._l((items),function(item){return _c('v-card',{key:item.id,staticClass:\"mt-4\",attrs:{\"flat\":\"\"},on:{\"click\":function($event){return _vm.retrieveMessages(item)}}},[_c('v-list-item',{staticClass:\"grow\"},[_c('v-layout',{attrs:{\"align-center\":\"\",\"justify-space-around\":\"\"}},[_c('v-layout',[_c('v-list-item-avatar',{attrs:{\"color\":\"grey darken-3\"}},[(item.info.image)?_c('img',{attrs:{\"src\":(\"http://127.0.0.1:8000/images/\" + (item.info.image)),\"height\":\"90\",\"width\":\"90\",\"alt\":\"Profile Image\"}}):_c('span',{staticClass:\"white--text text-h6\"},[_vm._v(_vm._s(item.info.first_name[0])+_vm._s(item.info.last_name[0]))])]),_c('v-list-item-content',[_c('v-list-item-title',[_vm._v(_vm._s(item.info.first_name)+\" \"+_vm._s(item.info.last_name))]),_c('v-list-item-subtitle',[_vm._v(_vm._s(item.email))]),_c('v-layout',[_c('v-chip',{staticClass:\"white--text mt-1\",attrs:{\"color\":item.status == 'Pending' ? 'red darken-2' : 'green darken-2',\"x-small\":\"\"}},[_vm._v(_vm._s(item.status))])],1)],1)],1),_c('div',[_c('v-chip',{directives:[{name:\"show\",rawName:\"v-show\",value:(item.unreadCount > 0),expression:\"item.unreadCount > 0\"}],staticClass:\"white--text mt-1\",attrs:{\"color\":\"green darken-1\",\"x-small\":\"\"}},[_vm._v(_vm._s(item.unreadCount))])],1)],1)],1)],1)})}}],null,false,2830298557)})],1):_c('section',[_c('v-layout',[_c('v-btn',{staticClass:\"mt-4 mb-2\",attrs:{\"text\":\"\"},on:{\"click\":function($event){$event.preventDefault();_vm.hasSelected = false;\n       _vm.chatID = '';}}},[_c('v-icon',[_vm._v(\" mdi-arrow-left \")]),_c('span',{},[_vm._v(_vm._s(_vm.chatUserName))])],1)],1),_c('main',[_vm._l((_vm.messages),function(msg,index){return _c('div',{key:'index-' + index,class:['message', _vm.sentOrReceived(msg.userUID)]},[_c('p',[_vm._v(_vm._s(msg.text))])])}),_c('div',{ref:\"scrollable\"})],2),_c('form',{on:{\"submit\":function($event){$event.preventDefault();return _vm.sendMessage.apply(null, arguments)}}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.message),expression:\"message\"}],attrs:{\"type\":\"text\",\"placeholder\":\"Enter your message!\"},domProps:{\"value\":(_vm.message)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.message=$event.target.value}}}),_c('button',{staticClass:\"btn-send\",attrs:{\"disabled\":!_vm.message,\"type\":\"submit\"}},[_vm._v(\"📩\")])])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n <v-container class=\"\">\r\n  <v-row align=\"center\" justify=\"center\">\r\n   <v-col cols=\"12\" sm=\"10\" md=\"10\" lg=\"8\">\r\n    <v-app-bar-nav-icon class=\"mt-6\" v-if=\"!hasSelected\" @click.stop=\"setDrawerState\"></v-app-bar-nav-icon>\r\n    <v-layout column v-if=\"!hasSelected\" class=\"mt-7\">\r\n     <v-card-title>\r\n      <v-text-field\r\n       v-model=\"search\"\r\n       append-icon=\"mdi-magnify\"\r\n       label=\"Search\"\r\n       single-line\r\n       hide-details\r\n       outlined\r\n       class=\"pt-0\"\r\n      ></v-text-field>\r\n     </v-card-title>\r\n     <v-card-title>\r\n      <v-select v-model=\"selectedStatus\" @change=\"getAccounts\" :items=\"filterStatus\" label=\"Status\" outlined></v-select>\r\n     </v-card-title>\r\n     <h4 class=\"mt-3 mb-3 ml-4 font-weight-regular\">Select a user to start a chat</h4>\r\n     <v-data-iterator sort-by=\"\" :items=\"accounts\" :loading=\"initialLoading\">\r\n      <template v-slot:default=\"{ items }\">\r\n       <v-card flat v-for=\"item in items\" :key=\"item.id\" class=\"mt-4\" @click=\"retrieveMessages(item)\">\r\n        <v-list-item class=\"grow\">\r\n         <v-layout align-center justify-space-around>\r\n          <v-layout>\r\n           <v-list-item-avatar color=\"grey darken-3\">\r\n            <img\r\n             v-if=\"item.info.image\"\r\n             :src=\"`http://127.0.0.1:8000/images/${item.info.image}`\"\r\n             height=\"90\"\r\n             width=\"90\"\r\n             alt=\"Profile Image\"\r\n            />\r\n            <span v-else class=\"white--text text-h6\">{{ item.info.first_name[0] }}{{ item.info.last_name[0] }}</span>\r\n           </v-list-item-avatar>\r\n           <v-list-item-content>\r\n            <v-list-item-title>{{ item.info.first_name }} {{ item.info.last_name }}</v-list-item-title>\r\n            <v-list-item-subtitle>{{ item.email }}</v-list-item-subtitle>\r\n            <v-layout>\r\n             <v-chip\r\n              class=\"white--text mt-1\"\r\n              :color=\"item.status == 'Pending' ? 'red darken-2' : 'green darken-2'\"\r\n              x-small\r\n              >{{ item.status }}</v-chip\r\n             >\r\n            </v-layout>\r\n           </v-list-item-content>\r\n          </v-layout>\r\n          <div>\r\n           <v-chip v-show=\"item.unreadCount > 0\" class=\"white--text mt-1\" color=\"green darken-1\" x-small>{{\r\n            item.unreadCount\r\n           }}</v-chip>\r\n          </div>\r\n         </v-layout>\r\n        </v-list-item>\r\n       </v-card>\r\n      </template>\r\n     </v-data-iterator>\r\n    </v-layout>\r\n\r\n    <section v-else>\r\n     <v-layout>\r\n      <v-btn\r\n       text\r\n       v-on:click.prevent=\"\r\n        hasSelected = false;\r\n        chatID = '';\r\n       \"\r\n       class=\"mt-4 mb-2\"\r\n      >\r\n       <v-icon>\r\n        mdi-arrow-left\r\n       </v-icon>\r\n       <span class=\"\">{{ chatUserName }}</span>\r\n      </v-btn>\r\n     </v-layout>\r\n     <main>\r\n      <div\r\n       v-for=\"(msg, index) in messages\"\r\n       v-bind:key=\"'index-' + index\"\r\n       :class=\"['message', sentOrReceived(msg.userUID)]\"\r\n      >\r\n       <p>{{ msg.text }}</p>\r\n      </div>\r\n      <div ref=\"scrollable\"></div>\r\n     </main>\r\n\r\n     <form v-on:submit.prevent=\"sendMessage\">\r\n      <input v-model=\"message\" type=\"text\" placeholder=\"Enter your message!\" />\r\n      <button class=\"btn-send\" :disabled=\"!message\" type=\"submit\">📩</button>\r\n     </form>\r\n    </section>\r\n   </v-col>\r\n  </v-row>\r\n </v-container>\r\n</template>\r\n<script>\r\n import { mapState } from 'vuex';\r\n import firebase from 'firebase';\r\n export default {\r\n  async mounted() {\r\n   document.title = 'Chat Application - Evsu-TES';\r\n   await this.$store.dispatch('auth/checkUser');\r\n   await this.getAccounts();\r\n   this.getUnreadCount();\r\n  },\r\n  data() {\r\n   return {\r\n    db: firebase.firestore(),\r\n    message: '',\r\n    messages: [],\r\n    chatID: '',\r\n    search: '',\r\n    hasSelected: false,\r\n    chatUserName: '',\r\n    filterStatus: ['Officially Enrolled', 'Unofficial', 'All Records'],\r\n    selectedStatus: 'All Records',\r\n   };\r\n  },\r\n  computed: {\r\n   ...mapState('auth', ['user']),\r\n   ...mapState('auth', ['accounts']),\r\n  },\r\n  methods: {\r\n   async getUnreadCount() {\r\n    if (this.accounts.length != 0) {\r\n     this.accounts.map((element) => {\r\n      let query = firebase.firestore().collection('messages');\r\n      query = query.where('chatID', '==', element.student_number);\r\n      query = query.where('seen', '==', false);\r\n      query.onSnapshot((querySnap) => {\r\n       let unread = 0;\r\n       querySnap.docs.map((doc) => {\r\n        if(doc.data().userUID != this.user.id){\r\n         unread++;\r\n        }\r\n       });\r\n       element.unreadCount = unread;\r\n       // console.log(`Unread from ${element.student_number}: ${unread}`);\r\n      });\r\n     });\r\n    }\r\n   },\r\n   async getAccounts() {\r\n    await this.$store.dispatch('auth/getAccounts', { search: this.search, status: this.selectedStatus });\r\n   },\r\n   retrieveMessages(item) {\r\n    this.hasSelected = true;\r\n    this.chatID = item.student_number;\r\n    this.chatUserName = item.info.first_name + ' ' + item.info.last_name;\r\n\r\n    let updateUnseen = firebase.firestore().collection('messages');\r\n    updateUnseen = updateUnseen.where('chatID', '==', item.student_number);\r\n    updateUnseen = updateUnseen.orderBy('createdAt');\r\n    updateUnseen.get().then((query) => {\r\n     query.forEach((doc) => {\r\n      if(doc.data().userUID != this.user.id){\r\n       doc.ref.update({ seen: true });\r\n      }\r\n     });\r\n    });\r\n\r\n    let query = firebase.firestore().collection('messages');\r\n    query = query.where('chatID', '==', item.student_number);\r\n    query = query.orderBy('createdAt');\r\n    query.onSnapshot((querySnap) => {\r\n     this.messages = querySnap.docs.map((doc) => doc.data());\r\n    });\r\n   },\r\n   setDrawerState() {\r\n    this.$store.commit('updates/SET_DRAWER_STATE');\r\n   },\r\n   sentOrReceived(userUID) {\r\n    return userUID === this.user.id ? 'sent' : 'received';\r\n   },\r\n   async sendMessage() {\r\n    const messageInfo = {\r\n     userUID: this.user.id,\r\n     displayName: this.user.info.first_name + ' ' + this.user.info.last_name,\r\n     text: this.message,\r\n     createdAt: Date.now(),\r\n     chatID: this.chatID,\r\n     seen: false,\r\n    };\r\n    await this.db.collection('messages').add(messageInfo);\r\n    this.message = '';\r\n    this.$refs['scrollable'].scrollIntoView({ behavior: 'smooth' });\r\n   },\r\n  },\r\n  watch: {\r\n   search() {\r\n    if (this.timeout) clearTimeout(this.timeout);\r\n    this.timeout = setTimeout(() => {\r\n     this.getAccounts();\r\n    }, 900);\r\n   },\r\n  },\r\n };\r\n</script>\r\n\r\n<style scoped>\r\n section {\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n }\r\n\r\n section main {\r\n  padding: 10px;\r\n  height: 100%;\r\n  overflow-y: scroll;\r\n  display: flex;\r\n  flex-direction: column;\r\n  max-height: 80vh;\r\n  min-height: 76vh;\r\n }\r\n\r\n form {\r\n  height: 6vh;\r\n  bottom: 0;\r\n  width: 100%;\r\n  display: flex;\r\n  margin-top: 5px;\r\n  font-size: 1rem;\r\n }\r\n\r\n input {\r\n  line-height: 1.3;\r\n  width: 100%;\r\n  font-size: 1rem;\r\n  outline: none;\r\n  border: none;\r\n  padding: 0 15px;\r\n }\r\n\r\n input {\r\n  color: rgb(0, 0, 0);\r\n  border-top-left-radius: 5px;\r\n  border-bottom-left-radius: 5px;\r\n  border: 1px solid grey;\r\n }\r\n\r\n p {\r\n  max-width: 500px;\r\n  margin-bottom: 12px;\r\n  line-height: 24px;\r\n  padding: 10px 20px;\r\n  border-radius: 20px;\r\n  position: relative;\r\n  color: white;\r\n  text-align: center;\r\n }\r\n\r\n .message {\r\n  display: flex;\r\n  align-items: center;\r\n }\r\n .message.received p {\r\n  background: #e5e5ea;\r\n  color: #000;\r\n  margin-top: 3px;\r\n }\r\n .message.sent {\r\n  flex-direction: row-reverse;\r\n  align-self: flex-end;\r\n }\r\n\r\n .message.sent p {\r\n  color: #fff;\r\n  background: #0b93f6;\r\n  margin-top: 3px;\r\n }\r\n\r\n .btn-send {\r\n  background: #0b93f6;\r\n  padding: 0rem 1rem;\r\n  border-top-right-radius: 5px;\r\n  border-bottom-right-radius: 5px;\r\n }\r\n</style>\r\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Chat.vue?vue&type=template&id=35b8add7&scoped=true&\"\nimport script from \"./Chat.vue?vue&type=script&lang=js&\"\nexport * from \"./Chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Chat.vue?vue&type=style&index=0&id=35b8add7&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"35b8add7\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VAppBarNavIcon } from 'vuetify/lib/components/VAppBar';\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VChip } from 'vuetify/lib/components/VChip';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VDataIterator } from 'vuetify/lib/components/VDataIterator';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VLayout } from 'vuetify/lib/components/VGrid';\nimport { VListItem } from 'vuetify/lib/components/VList';\nimport { VListItemAvatar } from 'vuetify/lib/components/VList';\nimport { VListItemContent } from 'vuetify/lib/components/VList';\nimport { VListItemSubtitle } from 'vuetify/lib/components/VList';\nimport { VListItemTitle } from 'vuetify/lib/components/VList';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSelect } from 'vuetify/lib/components/VSelect';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VAppBarNavIcon,VBtn,VCard,VCardTitle,VChip,VCol,VContainer,VDataIterator,VIcon,VLayout,VListItem,VListItemAvatar,VListItemContent,VListItemSubtitle,VListItemTitle,VRow,VSelect,VTextField})\n","// Components\nimport VIcon from '../VIcon'\nimport VBtn from '../VBtn/VBtn'\n\n// Types\nimport Vue from 'vue'\n\n/* @vue/component */\nexport default Vue.extend({\n  name: 'v-app-bar-nav-icon',\n\n  functional: true,\n\n  render (h, { slots, listeners, props, data }) {\n    const d = Object.assign(data, {\n      staticClass: (`v-app-bar__nav-icon ${data.staticClass || ''}`).trim(),\n      props: {\n        ...props,\n        icon: true,\n      },\n      on: listeners,\n    })\n\n    const defaultSlot = slots().default\n\n    return h(VBtn, d, defaultSlot || [h(VIcon, '$menu')])\n  },\n})\n","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=style&index=0&id=35b8add7&scoped=true&lang=css&\"","import VCard from './VCard'\nimport { createSimpleFunctional } from '../../util/helpers'\n\nconst VCardActions = createSimpleFunctional('v-card__actions')\nconst VCardSubtitle = createSimpleFunctional('v-card__subtitle')\nconst VCardText = createSimpleFunctional('v-card__text')\nconst VCardTitle = createSimpleFunctional('v-card__title')\n\nexport {\n  VCard,\n  VCardActions,\n  VCardSubtitle,\n  VCardText,\n  VCardTitle,\n}\n\nexport default {\n  $_vuetify_subcomponents: {\n    VCard,\n    VCardActions,\n    VCardSubtitle,\n    VCardText,\n    VCardTitle,\n  },\n}\n","// Styles\nimport './VCard.sass'\n\n// Extensions\nimport VSheet from '../VSheet'\n\n// Mixins\nimport Loadable from '../../mixins/loadable'\nimport Routable from '../../mixins/routable'\n\n// Helpers\nimport mixins from '../../util/mixins'\n\n// Types\nimport { VNode } from 'vue'\n\n/* @vue/component */\nexport default mixins(\n  Loadable,\n  Routable,\n  VSheet\n).extend({\n  name: 'v-card',\n\n  props: {\n    flat: Boolean,\n    hover: Boolean,\n    img: String,\n    link: Boolean,\n    loaderHeight: {\n      type: [Number, String],\n      default: 4,\n    },\n    raised: Boolean,\n  },\n\n  computed: {\n    classes (): object {\n      return {\n        'v-card': true,\n        ...Routable.options.computed.classes.call(this),\n        'v-card--flat': this.flat,\n        'v-card--hover': this.hover,\n        'v-card--link': this.isClickable,\n        'v-card--loading': this.loading,\n        'v-card--disabled': this.disabled,\n        'v-card--raised': this.raised,\n        ...VSheet.options.computed.classes.call(this),\n      }\n    },\n    styles (): object {\n      const style: Dictionary<string> = {\n        ...VSheet.options.computed.styles.call(this),\n      }\n\n      if (this.img) {\n        style.background = `url(\"${this.img}\") center center / cover no-repeat`\n      }\n\n      return style\n    },\n  },\n\n  methods: {\n    genProgress () {\n      const render = Loadable.options.methods.genProgress.call(this)\n\n      if (!render) return null\n\n      return this.$createElement('div', {\n        staticClass: 'v-card__progress',\n        key: 'progress',\n      }, [render])\n    },\n  },\n\n  render (h): VNode {\n    const { tag, data } = this.generateRouteLink()\n\n    data.style = this.styles\n\n    if (this.isClickable) {\n      data.attrs = data.attrs || {}\n      data.attrs.tabindex = 0\n    }\n\n    return h(tag, this.setBackgroundColor(this.color, data), [\n      this.genProgress(),\n      this.$slots.default,\n    ])\n  },\n})\n"],"sourceRoot":""}